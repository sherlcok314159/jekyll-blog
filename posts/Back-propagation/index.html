<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Going Deeper into Back-propagation" /><meta property="og:locale" content="en" /><meta name="description" content="1. Gradient descent optimization" /><meta property="og:description" content="1. Gradient descent optimization" /><link rel="canonical" href="https://www.yunpengtai.top/posts/Back-propagation/" /><meta property="og:url" content="https://www.yunpengtai.top/posts/Back-propagation/" /><meta property="og:site_name" content="Yunpeng Tai" /><meta property="og:image" content="https://s2.loli.net//2022/09/07/uajAxEbG9kCe7hM.jpg" /><meta property="og:image:height" content="100" /><meta property="og:image:width" content="600" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-09-07T11:10:00+08:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://s2.loli.net//2022/09/07/uajAxEbG9kCe7hM.jpg" /><meta property="twitter:title" content="Going Deeper into Back-propagation" /><meta name="twitter:site" content="@TonySta14611077" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-02-04T14:22:51+08:00","datePublished":"2022-09-07T11:10:00+08:00","description":"1. Gradient descent optimization","headline":"Going Deeper into Back-propagation","image":{"width":600,"height":100,"url":"https://www.yunpengtai.top/2022/09/07/uajAxEbG9kCe7hM.jpg","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.yunpengtai.top/posts/Back-propagation/"},"url":"https://www.yunpengtai.top/posts/Back-propagation/"}</script><title>Going Deeper into Back-propagation | Yunpeng Tai</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Yunpeng Tai"><meta name="application-name" content="Yunpeng Tai"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="https://avatars.githubusercontent.com/u/76043326?s=400&u=1f9b3c508db6b5caec736e7c1edb42ba76e2f2a1&v=4" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Yunpeng Tai</a></div><div class="site-subtitle font-italic">Learn to think</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/sherlcok314159" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/TonySta14611077" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['yunpengtai.typ','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Going Deeper into Back-propagation</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Going Deeper into Back-propagation</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1662520200" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Sep 7, 2022 </em> </span> <span> Updated <em class="" data-ts="1675491771" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Feb 4, 2023 </em> </span><div class="mt-3 mb-3"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 600 100'%3E%3C/svg%3E" data-src="https://s2.loli.net//2022/09/07/uajAxEbG9kCe7hM.jpg" class="preview-img bg" alt="Preview Image" width="600" height="100" data-proofer-ignore></div><div class="d-flex justify-content-between"> <span></span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1030 words"> <em>5 min</em> read</span></div></div></div><div class="post-content"><h3 id="1-gradient-descent-optimization"><span class="mr-2">1. Gradient descent optimization</span><a href="#1-gradient-descent-optimization" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Gradient-based methods make use of the gradient information to adjust the parameters. Among them, gradient descent can be the simplest. Gradient descent makes the parameters to walk a small step in the direction of the negative gradient.</p>\[\boldsymbol{w}^{\tau + 1} = \boldsymbol{w}^{\tau} - \eta \nabla_{\boldsymbol{w}^{\tau}} E \tag{1.1}\]<p>where $\eta, \tau, E$ label learning rate ($\eta &gt; 0$), the iteration step and the loss function.</p><p>Wait! But why is the negative gradient?</p><h3 id="2-why-negative-gradient"><span class="mr-2">2. Why negative gradient</span><a href="#2-why-negative-gradient" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><blockquote class="prompt-info"><div><p>The function increases the most sharply by following the direction of the gradient.</p></div></blockquote><p>The below is an example. The three-dimensional plane is $z = F(x, y)$. The black point is on the plane. You can try to move the point to see how the arrow changes. Interestingly, the arrow always points to the direction which leads to the <code class="language-plaintext highlighter-rouge">biggest</code> increase of the function value. Note that when you move one step, the gradient just changes. Thus if you still want to increase the function value in the most sharp way, another computation is needed.</p><blockquote class="prompt-tip"><div><p>The starting point of the arrow is the mapping of the black point to the $xoy$ plane. The arrow is parallel to the gradient.</p></div></blockquote><center><iframe scrolling="no" title="Directional derivatives and Gradient" src="https://www.geogebra.org/material/iframe/id/wd5mrudh/width/700/height/500/border/888888/rc/false/ai/false/sdz/false/smb/false/stb/false/stbh/false/ld/false/sri/false/at/auto" width="600px" height="390px" style="border:0px;"> </iframe></center><p>Let us use another graph to better understand what the mapping means. The left graph is contour plot while the right is the plane. The red point is just the mapping of the black point to $xoy$ plane. The blue arrow is just the direction of the gradient. And you can move the point to feel about it.</p><center><iframe scrolling="no" title="Directional derivatives and Gradient" src="https://www.geogebra.org/material/iframe/id/vpt37qtt/width/788/height/520/border/888888/sfsb/true/smb/false/stb/false/stbh/false/ai/false/asb/false/sri/false/rc/false/ld/false/sdz/true/ctl/false" width="600px" height="420px" style="border:0px;"> </iframe></center><p>That is the <code class="language-plaintext highlighter-rouge">intuitive</code> way to feel about the gradient. Furthermore, we can just try to prove it<sup id="fnref:1" role="doc-noteref"><a href="#fn:1" class="footnote" rel="footnote">1</a></sup>.</p><p>Consider a Taylor Expansion:</p>\[\begin{aligned} F(\boldsymbol{r_0} + \boldsymbol{r}) &amp;= F(\boldsymbol{r_0}) + \nabla_{r_0}F \cdot \boldsymbol{r}\\ &amp;= F(\boldsymbol{r_0}) + \|\nabla_{r_0}F\|\cdot \|\boldsymbol{r}\| \cdot \cos \theta \end{aligned}\tag{2.1}\]<p>When you decide to move a small step, the two magnitudes are certain. If $\theta=0$, you can maximize the function value (i.e. <code class="language-plaintext highlighter-rouge">in the direction of the gradient</code>).</p><p>Thus if we want to minimize our loss function, we need to go in the opposite direction of the gradient. That is why we need a negative gradient. Also, note that Taylor Expansion only applies to small $\Delta x$ which further requires $\eta$ to be small (e.g. $2 \times 10^{-5}, 5 \times 10^{-5}$).</p><p>But how to compute the gradient needs a powerful technique: back-propagation.</p><h3 id="3-definition-of-back-propagation"><span class="mr-2">3. Definition of back-propagation</span><a href="#3-definition-of-back-propagation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><blockquote class="prompt-tip"><div><p>Back-propagation allows information from the cost to then flow backwards through the network, in order to compute the gradients used to adjust the parameters.</p></div></blockquote><p>Back-propagation can be new to the novices, but it does exist in the life widely. For instance, the loss can be your teacher’s attitude towards you. If you fail in one examination, your teacher can be disappointed with you. Then, he can tell your parents about your failure. Your parents then ask you to work harder to win the examination.</p><p>Your parents can be seen as <code class="language-plaintext highlighter-rouge">hidden units</code> in the neural network, and you are the parameter of the network. Your teacher’s bad attitude towards your failure can ask you to make adjustments: working harder. Similarly, the loss can require the parameters to make adjustments via gradients.</p><h3 id="4-chain-rule"><span class="mr-2">4. Chain Rule</span><a href="#4-chain-rule" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Suppose $z = f(y), y = g(x) \implies z = (f \circ g)(x)$, how to calculate the derivative of $z$ with respect to $x$? The chain rule of calculus is used to compute the derivatives of functions formed by composing other functions whose derivatives are known.</p>\[\frac{dz}{dx} = \frac{dz}{dy} \frac{dy}{dx} \tag{4.1}\]<h3 id="5-case-study"><span class="mr-2">5. Case Study</span><a href="#5-case-study" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 300 600'%3E%3C/svg%3E" data-src="https://s2.loli.net/2022/09/07/iTFg9de8RyfJavm.png" alt="backprop2.png" width="300" height="600" data-proofer-ignore></p><p>Let’s first see an important example. In fully connected layers, one input neuron sends information (i.e., multiplied by weights) to every output neuron. Denote $w_{ji}$ as the weight from $x_i$ to $y_j$. Then for every output neuron (e.g., $y_j$), it accepts the information sent by every input neuron:</p>\[y_{j}= \sum\limits_{i} w_{ji} x_{i} \tag{5.1}\]<p>Then the partial derivative of $y_j$ with respect to $x_i$:</p>\[\frac{\partial y_j}{\partial x_{i}}= w_{ji} \tag{5.2}\]<p>Let’s see another example<sup id="fnref:2" role="doc-noteref"><a href="#fn:2" class="footnote" rel="footnote">2</a></sup>. It is represented by the computational graph<sup id="fnref:3" role="doc-noteref"><a href="#fn:3" class="footnote" rel="footnote">3</a></sup> below.</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 300 600'%3E%3C/svg%3E" data-src="https://s2.loli.net/2022/09/07/QOJYtIw6BNmsc2i.png" alt="backprop1.png" width="300" height="600" data-proofer-ignore></p><p>And we can perform a forward propagation according to the computational graph.</p>\[\begin{align} h_{j} &amp;= \sum\limits_{i} w_{ji}^{(1)} x_{i} \tag{5.3} \\ z_{j} &amp;= f(h_{j}) \tag{5.4} \\ y_{k} &amp;= \sum\limits_{j}w_{kj}^{(2)} z_{j} \tag{5.5} \end{align}\]<p>where</p>\[f(h) = \tanh(h) = \frac{e^h - e^{-h}}{e^h + e^{-h}} \tag{5.6}\]<p>A useful feature of this activation is that its derivative can be expressed in a particularly simple form:</p>\[f'(h) = 1 - f(h)^2 \tag{5.7}\]<p>The error function can be mean squared errors:</p>\[E(\boldsymbol{w}) = \frac{1}{2} \sum\limits_{k}(y_{k}- \hat{y}_k)^2 \tag{5.8}\]<p>If we want to update the parameters, we need first to compute the partial derivative of $E(\boldsymbol{w})$ with respect to them.</p>\[\frac{\partial E(\boldsymbol{w})}{\partial w_{kj}^{(2)}} = \frac{\partial E(\boldsymbol{w})}{\partial y_{k}} \frac{\partial y_k}{\partial w_{kj}^{(2)}} = (y_{k}- \hat{y}_k)z_{j} \tag{5.9}\] \[\begin{align} \frac{\partial E(\boldsymbol{w})}{\partial w_{ji}^{(1)}} &amp;= \frac{\partial E(\boldsymbol{w})}{\partial h_{j}}\frac{\partial h_j}{\partial w_{ji}^{(1)}} = (\frac{\partial E(\boldsymbol{w})}{\partial z_{j}} \frac{\partial z_j}{\partial h_j})x_{i} \tag{5.10} \\ \end{align}\] \[\frac{\partial E(\boldsymbol{w})}{\partial z_j} = \sum\limits_{k}\frac{\partial E(\boldsymbol{w})}{\partial y_{k}}\frac{\partial y_k}{\partial z_{j}}= \sum\limits_{k} (y_{k}- \hat{y}_{k}) w_{kj}^{(2)}\tag{5.11}\]<p>$\text{Remark.}$ $z_j$ can send information to all the output neurons (e.g., $y_k$), thus we need to sum over all the derivatives with respect to $z_j$.</p><p>Substituting $\text{(4.11)}$ into $\text{(4.10)}$ we obtain</p>\[\frac{\partial E(\boldsymbol{w})}{\partial w_{ji}^{(1)}} = (1 - z_j^2)x_{i} \sum\limits_{k} (y_{k}- \hat{y}_{k}) w_{kj}^{(2)} \tag{5.12}\]<h3 id="6-interpretation"><span class="mr-2">6. Interpretation</span><a href="#6-interpretation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Recall the Taylor approximation of the two variables function:</p>\[f(x, y) = f(x_0, y_0) + f_x (x- x_0) + f_y(y-y_0) \tag{6.1}\]<p>$\text{Remark.}$ $(x, y)$ needs to be close to $(x_0, y_0)$, otherwise the approximation can fail.</p><p>We can transform $\text{(5.1)}$ into $\text{(5.3)}$:</p>\[\begin{align} f(x,y) - f(x_{0},y_0) &amp;= f_x (x- x_0) + f_y(y-y_0) \tag{6.2}\\ \implies \Delta f &amp;= f_x \Delta x + f_y \Delta y\tag{6.3} \end{align}\]<p>If we apply $\text{(5.3)}$ in the example above, we can obtain</p>\[\Delta E(\boldsymbol{w}) = \nabla_{\boldsymbol{w}}E(\boldsymbol{w}) \Delta \boldsymbol{w} \tag{6.4}\]<p>From another perspective, a small change in the parameters will propagate into a small change in object function by getting multiplied by the gradient.</p><blockquote class="prompt-info"><div><p>To summarize, back-propagation allows information to flow backwards through the network. This information can tell the model a small change in one particular parameter can result in what change in the object function. And gradient descent can use this information to adjust the parameters for optimizing the object function.</p></div></blockquote><h3 id="7-references"><span class="mr-2">7. References</span><a href="#7-references" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="footnotes" role="doc-endnotes"><ol><li id="fn:1" role="doc-endnote"><p>https://math.stackexchange.com/questions/223252/why-is-gradient-the-direction-of-steepest-ascent <a href="#fnref:1" class="reversefootnote" role="doc-backlink">&#8617;</a></p><li id="fn:2" role="doc-endnote"><p>Bishop-Pattern-Recognition-and-Machine-Learning-2006 <a href="#fnref:2" class="reversefootnote" role="doc-backlink">&#8617;</a></p><li id="fn:3" role="doc-endnote"><p>Ian Goodfellow, Yoshua Bengio, Aaron Courville - Deep Learning [draft of March 30, 2015] (2016, MIT Press) <a href="#fnref:3" class="reversefootnote" role="doc-backlink">&#8617;</a></p></ol></div><hr><h4>Sponsoring</h4><p>If you think of something really helpful, please consider sponsoring me! Any support is well appreciated! &#128516;&#128516;&#128516;</p><a href="https://ko-fi.com/yunpengtai"><img data-src="https://img.shields.io/badge/-Buy%20Me%20a%20Coffee-ff5f5f?logo=ko-fi&amp;logoColor=https://s2.loli.net/white" data-proofer-ignore></a> <a href="https://s2.loli.net/2022/06/19/wfh2rnYBq8vzZuD.jpg"><img data-src="https://img.shields.io/badge/-Tip%20Me%20on%20WeChat-brightgreen?logo=wechat&logoColor=https://s2.loli.net/white" data-proofer-ignore> </a> <a href="https://s2.loli.net/2022/06/19/kxm7wo8f3zTrcWt.jpg"><img data-src="https://img.shields.io/badge/-Tip%20Me%20on%20Alipay-blue?logo=alipay&logoColor=https://s2.loli.net/white" data-proofer-ignore></a></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/training/'>Training</a>, <a href='/categories/deep-learning/'>Deep Learning</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/gradients/" class="post-tag no-text-decoration" >Gradients</a> <a href="/tags/optimization/" class="post-tag no-text-decoration" >Optimization</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Going+Deeper+into+Back-propagation+-+Yunpeng+Tai&url=https%3A%2F%2Fwww.yunpengtai.top%2Fposts%2FBack-propagation%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Going+Deeper+into+Back-propagation+-+Yunpeng+Tai&u=https%3A%2F%2Fwww.yunpengtai.top%2Fposts%2FBack-propagation%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fwww.yunpengtai.top%2Fposts%2FBack-propagation%2F&text=Going+Deeper+into+Back-propagation+-+Yunpeng+Tai" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Back-propagation/">Going Deeper into Back-propagation</a><li><a href="/posts/Diving-in-distributed-training/">Diving in distributed training in PyTorch</a><li><a href="/posts/hello-world/">Hello World</a><li><a href="/posts/Tips-for-Training-Neural-Networks/">Tips for Training Neural Networks</a><li><a href="/posts/Quotes-of-Mathematicians/">Quotes of Mathematicians</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/1st-post/">1st post</a> <a class="post-tag" href="/tags/dataparallel/">DataParallel</a> <a class="post-tag" href="/tags/distributed-training/">Distributed Training</a> <a class="post-tag" href="/tags/experience/">Experience</a> <a class="post-tag" href="/tags/gradients/">Gradients</a> <a class="post-tag" href="/tags/hello-world/">hello world</a> <a class="post-tag" href="/tags/mathematics/">Mathematics</a> <a class="post-tag" href="/tags/multi-gpus/">Multi-gpus</a> <a class="post-tag" href="/tags/neural-networks/">Neural Networks</a> <a class="post-tag" href="/tags/optimization/">Optimization</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Tips-for-Training-Neural-Networks/"><div class="card-body"> <em class="small" data-ts="1659181380" data-df="ll" > Jul 30, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Tips for Training Neural Networks</h3><div class="text-muted small"><p> Recently, I have read a blog about training neural networks (simplified as NN in the rest part of this post) and it is really amazing. I am going to add my own experience in this post along with su...</p></div></div></a></div><div class="card"> <a href="/posts/Diving-in-distributed-training/"><div class="card-body"> <em class="small" data-ts="1668951420" data-df="ll" > Nov 20, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Diving in distributed training in PyTorch</h3><div class="text-muted small"><p> 鉴于网上此类教程有不少模糊不清，对原理不得其法，代码也难跑通，故而花了几天细究了一下相关原理和实现，欢迎批评指正！ 关于此部分的代码，可以去这里查看 在开始前，我需要特别致谢一下一位挚友，他送了我双显卡的机器来赞助我做个人研究，否则多卡的相关实验就得付费在云平台上跑了，感谢好朋友一路以来的支持，这份恩情值得一辈子铭记！这篇文章作为礼物赠与挚友。 Why Parallel 我们...</p></div></div></a></div><div class="card"> <a href="/posts/Quotes-of-Mathematicians/"><div class="card-body"> <em class="small" data-ts="1658541360" data-df="ll" > Jul 23, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Quotes of Mathematicians</h3><div class="text-muted small"><p> Life is complex, and it has both real and imaginary parts. — Someone Basically, I’m not interested in doing research and I never have been… I’m interested in understanding, which is quite a di...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Tips-for-Training-Neural-Networks/" class="btn btn-outline-primary" prompt="Older"><p>Tips for Training Neural Networks</p></a> <a href="/posts/Diving-in-distributed-training/" class="btn btn-outline-primary" prompt="Newer"><p>Diving in distributed training in PyTorch</p></a></div><script src="https://unpkg.com/@waline/client@v2/dist/waline.js"></script><link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css" /><div id="waline"></div><script> $(function() { const locale = { placeholder: '可以匿名评论哦~ QQ邮箱可自动获取头像 Anything to say? It can be anonymous.', level0: '潜水', level1: '冒泡', level2: '摸鱼', level3: '话痨', level4: '话满天', level5: '龙王', }; Waline.init({ el: '#waline', lang: 'en', reaction: true, serverURL: 'https://example.yunpengtai.top/', emoji: [ 'https://gcore.jsdelivr.net/gh/norevi/waline-blobcatemojis@1.0/blobs', 'https://unpkg.com/@waline/emojis@1.1.0/tw-emoji', 'https://unpkg.com/@waline/emojis@1.1.0/bmoji' ], reaction:[ 'https://gcore.jsdelivr.net/gh/norevi/waline-blobcatemojis@1.0/blobs/ablobcatheart.png', 'https://gcore.jsdelivr.net/gh/norevi/waline-blobcatemojis@1.0/blobs/ablobcatrainbow.png', 'https://gcore.jsdelivr.net/gh/norevi/waline-blobcatemojis@1.0/blobs/ablobcatattentionreverse.png', 'https://gcore.jsdelivr.net/gh/norevi/waline-blobcatemojis@1.0/blobs/ablobcatheartbroken.png', 'https://gcore.jsdelivr.net/gh/norevi/waline-blobcatemojis@1.0/blobs/blobcatopenmouth.png', 'https://gcore.jsdelivr.net/gh/norevi/waline-blobcatemojis@1.0/blobs/blobcatcoffee.png' ], dark: "__waline__css__", locale, }); let head = document.getElementsByTagName("head")[0]; let css = head.lastChild; let cssContent = css.textContent.replace("__waline__css__", ""); let cssContentPerferredDark = "@media (prefers-color-scheme: dark){html:not([data-mode])" + cssContent + "}"; let cssContentSelectedDark = "html[data-mode=dark]" + cssContent; css.textContent = cssContentPerferredDark; let style = document.createElement('style'); style.textContent = cssContentSelectedDark; head.appendChild(style); }); </script></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/TonySta14611077">Yunpeng Tai</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/1st-post/">1st post</a> <a class="post-tag" href="/tags/dataparallel/">DataParallel</a> <a class="post-tag" href="/tags/distributed-training/">Distributed Training</a> <a class="post-tag" href="/tags/experience/">Experience</a> <a class="post-tag" href="/tags/gradients/">Gradients</a> <a class="post-tag" href="/tags/hello-world/">hello world</a> <a class="post-tag" href="/tags/mathematics/">Mathematics</a> <a class="post-tag" href="/tags/multi-gpus/">Multi-gpus</a> <a class="post-tag" href="/tags/neural-networks/">Neural Networks</a> <a class="post-tag" href="/tags/optimization/">Optimization</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-Y3CX2RWEDY"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-Y3CX2RWEDY'); }); </script>
